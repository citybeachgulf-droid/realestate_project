{% extends 'base.html' %}
{% block title %}{{ _('Admin Dashboard') }}{% endblock %}

{% block content %}
<style>
/* شبكة الكروت */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

/* كرت الإحصائية */
.stat-card {
  border-radius: 15px;
  padding: 20px;
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: 0.3s;
}
.stat-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

/* روابط الكروت لتكون قابلة للنقر بدون تغيير الشكل */
a.stat-card-link {
  display: block;
  text-decoration: none;
  color: inherit;
}

.stat-card i {
  font-size: 2.5rem;
  margin-bottom: 10px;
  opacity: 0.9;
}

.stat-card span {
  font-weight: 600;
  font-size: 1rem;
}

.bg-income { background: linear-gradient(135deg, #28a745, #20c997); }
.bg-expense { background: linear-gradient(135deg, #dc3545, #ff6b6b); }
.bg-profit { background: linear-gradient(135deg, #0d6efd, #6ea8fe); }
.bg-house { background: linear-gradient(135deg, #6f42c1, #a56eff); }
.bg-maint { background: linear-gradient(135deg, #fd7e14, #ffb86c); }
.bg-employee { background: linear-gradient(135deg, #20c997, #0dcaf0); }
.bg-tenant { background: linear-gradient(135deg, #ffc107, #ffca2c); }
</style>

<h2 class="mb-4">{{ _('Admin Dashboard') }}</h2>

<!-- شبكة كروت الإحصائيات -->
<div class="dashboard-grid">
  <div class="stat-card bg-income">
    <i class="bi bi-cash-stack"></i>
    <span>{{ _('Income') }}</span>
    <span>{{ total_income }}</span>
  </div>
  <div class="stat-card bg-expense">
    <i class="bi bi-wallet2"></i>
    <span>{{ _('Expenses') }}</span>
    <span>{{ total_expenses }}</span>
  </div>
  <div class="stat-card bg-profit">
    <i class="bi bi-graph-up"></i>
    <span>{{ _('Profit') }}</span>
    <span>{{ profit }}</span>
  </div>
  <a href="{{ url_for('employee.properties_list') }}" class="stat-card-link">
    <div class="stat-card bg-house">
      <i class="bi bi-houses"></i>
      <span>{{ _('All Properties') }}</span>
      <span>{{ properties_count }}</span>
    </div>
  </a>
  <a href="{{ url_for('employee.properties_list', only='unleased') }}" class="stat-card-link">
    <div class="stat-card bg-house">
      <i class="bi bi-house-door"></i>
      <span>{{ _('Unleased Properties') }}</span>
      <span>{{ unleased_properties }}</span>
    </div>
  </a>
  <div class="stat-card bg-maint">
    <i class="bi bi-tools"></i>
    <span>{{ _('Maintenance >24h') }}</span>
    <span>{{ overdue_maintenance_24h }}</span>
  </div>
  <div class="stat-card bg-employee">
    <i class="bi bi-person"></i>
    <span>{{ _('Employees') }}</span>
    <span>{{ total_employees }}</span>
  </div>
  <a href="{{ url_for('admin.users_list', role='tenant') }}" class="stat-card-link">
    <div class="stat-card bg-tenant">
      <i class="bi bi-people"></i>
      <span>{{ _('Tenants') }}</span>
      <span>{{ total_tenants }}</span>
    </div>
  </a>
</div>

<!-- أحدث الشكاوى والصيانات -->
<h5 class="mt-4 mb-2">{{ _('Latest Complaints & Maintenance') }}</h5>
<div class="dashboard-grid">
  {% for c in latest_complaints %}
  <div class="stat-card bg-secondary text-dark">
    <i class="bi bi-exclamation-triangle"></i>
    <span>{{ c.subject }}</span>
    <span>#{{ c.id }} - {{ c.status }}</span>
  </div>
  {% else %}
  <div class="stat-card bg-light text-dark">{{ _('No complaints') }}</div>
  {% endfor %}

  {% for m in latest_maintenance %}
  <div class="stat-card bg-light text-dark">
    <i class="bi bi-tools"></i>
    <span>{{ m.title }}</span>
    <span>#{{ m.id }} - {{ m.status }}</span>
  </div>
  {% else %}
  <div class="stat-card bg-light text-dark">{{ _('No maintenance requests') }}</div>
  {% endfor %}
</div>

{% endblock %}
