{% extends 'base.html' %}
{% block title %}{{ _('Admin Dashboard') }}{% endblock %}

{% block content %}
<!-- Custom CSS -->
<style>
.dashboard-header {
  background: linear-gradient(135deg, #0d6efd, #6610f2);
  color: #fff;
  padding: 25px;
  border-radius: 15px;
  margin-bottom: 30px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}
.dashboard-header h2 {
  margin: 0;
  font-weight: 700;
}

.stat-card {
  border: none;
  border-radius: 15px;
  padding: 20px;
  color: #fff;
  height: 100%;
  transition: 0.3s;
}
.stat-card:hover {
  transform: translateY(-4px);
}
.stat-icon {
  font-size: 2rem;
  opacity: 0.8;
}

.bg-income { background: linear-gradient(135deg, #28a745, #20c997); }
.bg-expense { background: linear-gradient(135deg, #dc3545, #ff6b6b); }
.bg-profit { background: linear-gradient(135deg, #0d6efd, #6ea8fe); }
.bg-house { background: linear-gradient(135deg, #6f42c1, #a56eff); }
.bg-maint { background: linear-gradient(135deg, #fd7e14, #ffb86c); }

.table-card {
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}
</style>

<!-- Header -->
<div class="dashboard-header d-flex justify-content-between align-items-center">
  <h2>{{ _('Admin Dashboard') }}</h2>
  <div>
    <a class="btn btn-light btn-sm me-2" href="{{ url_for('admin.create_user', role='employee') }}">
      <i class="bi bi-person-plus"></i> {{ _('Add Employee') }}
    </a>
    <a class="btn btn-outline-light btn-sm me-2" href="{{ url_for('admin.create_user', role='tenant') }}">
      <i class="bi bi-person-plus-fill"></i> {{ _('Add Tenant') }}
    </a>
    <a class="btn btn-outline-light btn-sm" href="{{ url_for('admin.users_list') }}">
      <i class="bi bi-people"></i> {{ _('Manage Users') }}
    </a>
  </div>
</div>

<!-- Stats Row -->
<div class="row g-3">
  <div class="col-md-4">
    <div class="stat-card bg-income">
      <div class="d-flex justify-content-between">
        <div>
          <h6>{{ _('Income') }}</h6>
          <h3>{{ total_income }}</h3>
        </div>
        <i class="bi bi-cash-stack stat-icon"></i>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="stat-card bg-expense">
      <div class="d-flex justify-content-between">
        <div>
          <h6>{{ _('Expenses') }}</h6>
          <h3>{{ total_expenses }}</h3>
        </div>
        <i class="bi bi-wallet2 stat-icon"></i>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="stat-card bg-profit">
      <div class="d-flex justify-content-between">
        <div>
          <h6>{{ _('Profit') }}</h6>
          <h3>{{ profit }}</h3>
        </div>
        <i class="bi bi-graph-up stat-icon"></i>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mt-2">
  <div class="col-md-6">
    <div class="stat-card bg-house">
      <div class="d-flex justify-content-between">
        <div>
          <h6>{{ _('Unleased Properties') }}</h6>
          <h3>{{ unleased_properties }}</h3>
        </div>
        <i class="bi bi-house-door stat-icon"></i>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="stat-card bg-maint">
      <div class="d-flex justify-content-between">
        <div>
          <h6>{{ _('Maintenance Requests > 24h') }}</h6>
          <h3>{{ overdue_maintenance_24h }}</h3>
        </div>
        <i class="bi bi-tools stat-icon"></i>
      </div>
    </div>
  </div>
</div>

<!-- Latest Data -->
<div class="row mt-4">
  <div class="col-md-6">
    <div class="card table-card">
      <div class="card-header fw-bold">{{ _('Latest Complaints') }}</div>
      <div class="card-body p-0">
        <table class="table mb-0">
          <thead><tr><th>ID</th><th>{{ _('Subject') }}</th><th>{{ _('Status') }}</th></tr></thead>
          <tbody>
            {% for c in latest_complaints %}
            <tr>
              <td>#{{ c.id }}</td>
              <td>{{ c.subject }}</td>
              <td><span class="badge bg-secondary">{{ c.status }}</span></td>
            </tr>
            {% else %}
            <tr><td colspan="3">{{ _('No data') }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card table-card">
      <div class="card-header fw-bold">{{ _('Latest Maintenance Requests') }}</div>
      <div class="card-body p-0">
        <table class="table mb-0">
          <thead><tr><th>ID</th><th>{{ _('Title') }}</th><th>{{ _('Status') }}</th></tr></thead>
          <tbody>
            {% for m in latest_maintenance %}
            <tr>
              <td>#{{ m.id }}</td>
              <td>{{ m.title }}</td>
              <td><span class="badge bg-secondary">{{ m.status }}</span></td>
            </tr>
            {% else %}
            <tr><td colspan="3">{{ _('No data') }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
