{% extends 'base.html' %}
{% block title %}{{ _('Contract') }} #{{ contract.id }}{% endblock %}
{% block content %}
<h3 class="mb-3">{{ _('Contract') }} #{{ contract.id }}</h3>
<div class="card mb-3">
  <div class="card-body">
    <div class="row">
      <div class="col-md-6"><strong>{{ _('Property') }}:</strong> {{ contract.property.title }}</div>
      <div class="col-md-6"><strong>{{ _('Tenant') }}:</strong> {{ contract.tenant.username }}</div>
    </div>
    <div class="row mt-2">
      <div class="col-md-6"><strong>{{ _('Start') }}:</strong> {{ contract.start_date }}</div>
      <div class="col-md-6"><strong>{{ _('End') }}:</strong> {{ contract.end_date }}</div>
    </div>
    <div class="row mt-2">
      <div class="col-md-6"><strong>{{ _('Rent') }}:</strong> {{ contract.rent_amount }}</div>
      <div class="col-md-6"><strong>{{ _('Status') }}:</strong> {{ contract.status }}</div>
    </div>
    <div class="mt-3">
      {% if contract.document_path %}
      <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('uploaded_file', filename=contract.document_path) }}" target="_blank">{{ _('View Document') }}</a>
      {% endif %}
      <a class="btn btn-sm btn-secondary" href="{{ url_for('tenant.dashboard') }}">{{ _('Back') }}</a>
    </div>
  </div>
</div>

<h5 class="mt-4">{{ _('Payments') }}</h5>
<ul class="list-group">
  {% for p in contract.payments.order_by(contract.payments.entity.due_date.asc()).all() %}
  <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" href="{{ url_for('tenant.payment_show', payment_id=p.id) }}">
    <div>
      <strong>{{ _('Amount') }}: {{ p.amount }}</strong>
      <div class="text-muted small">{{ _('Due') }}: {{ p.due_date }}</div>
    </div>
    <span class="badge {{ 'text-bg-success' if p.status=='paid' else 'text-bg-warning' }}">{{ p.status }}</span>
  </a>
  {% else %}
  <li class="list-group-item">{{ _('No data') }}</li>
  {% endfor %}
</ul>
{% endblock %}
